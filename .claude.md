# EnergyPlus Automation Tool - Claude Context

**Projekt**: Automatisiertes GebÃ¤udemodellierungs- und Simulationstool fÃ¼r EnergyPlus
**Standort**: Salzburg, Ã–sterreich
**Erstellungsdatum**: 10.11.2025
**Letztes Update**: 10.11.2025

---

## ğŸ¯ PROJEKT-ZIEL

Entwicklung eines Python-basierten Tools zur:
- Automatischen Erstellung von EnergyPlus-GebÃ¤udemodellen
- DurchfÃ¼hrung von Simulationen (Standard, Co-Simulation, HIL)
- Auswertung und Optimierung von GebÃ¤udeenergiebedarfen
- Integration mit datengetriebenen Modellen (ML)

---

## ğŸ“ PROJEKT-STRUKTUR

```
AI_BS/
â”œâ”€â”€ .claude.md                    # DIESE DATEI - Kontext fÃ¼r Claude
â”œâ”€â”€ README.md                     # Hauptdokumentation
â”œâ”€â”€ STATUS.md                     # Aktueller technischer Status
â”œâ”€â”€ WAS_IST_MÃ–GLICH.md           # Feature-Ãœbersicht
â”œâ”€â”€ LIVE_DEMO_ERGEBNISSE.md      # Beispiel-Ergebnisse
â”œâ”€â”€ INSTALLATION_WSL.md          # WSL-Installation Guide
â”œâ”€â”€ QUICK_REFERENCE.md           # Schnellreferenz
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ default_config.yaml      # Hauptkonfiguration
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ geometry/
â”‚   â”‚   â””â”€â”€ simple_box.py        # âš ï¸ BUGGY - API-InkompatibilitÃ¤t
â”‚   â”œâ”€â”€ materials/
â”‚   â”‚   â””â”€â”€ standard_constructions.py  # âœ… Funktioniert
â”‚   â”œâ”€â”€ simulation/
â”‚   â”‚   â””â”€â”€ runner.py            # âœ… Funktioniert (Single & Batch)
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ config.py            # âœ… Konfigurationsmanagement
â”‚
â”œâ”€â”€ examples/
â”‚   â”œâ”€â”€ 01_simple_box_simulation.py  # âš ï¸ BenÃ¶tigt Fixes
â”‚   â””â”€â”€ 02_batch_simulation.py       # âš ï¸ BenÃ¶tigt Fixes
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_geometry.py
â”‚   â””â”€â”€ test_config.py
â”‚
â”œâ”€â”€ data/
â”‚   â””â”€â”€ weather/
â”‚       â””â”€â”€ example.epw          # âœ… Salzburg-Wetterdaten
â”‚
â”œâ”€â”€ output/                      # Simulationsergebnisse
â”‚
â”œâ”€â”€ quick_start.py               # âœ… FUNKTIONIERENDES Minimal-Beispiel
â”œâ”€â”€ demo_salzburg.py             # âš ï¸ In Entwicklung
â”œâ”€â”€ beispiel_salzburg_analyse.py # âœ… SQL-Analyse-Beispiel
â””â”€â”€ requirements.txt             # Python-Dependencies
```

---

## âœ… WAS FUNKTIONIERT (STAND 10.11.2025)

### 1. **EnergyPlus-Installation**
- **Version**: 23.2.0-7636e6b3e9
- **Pfad**: `/home/luma/EnergyPlus-23.2.0-7636e6b3e9-Linux-Ubuntu22.04-x86_64/`
- **Executable**: `~/EnergyPlus-.../energyplus`
- **Status**: âœ… VollstÃ¤ndig funktionsfÃ¤hig

### 2. **Python-Umgebung**
- **Python**: 3.10.12
- **Virtual Env**: `venv/`
- **Key Packages**: eppy 0.5.63, pandas, pydantic
- **Status**: âœ… Installiert und getestet

### 3. **Simulationen**
```bash
# Funktioniert:
~/EnergyPlus-.../energyplus \
  -w data/weather/example.epw \
  -d output/results \
  gebÃ¤ude.idf
```
- **Status**: âœ… Produktionsreif
- **Getestet**: Mit Salzburg-Wetter, verschiedene GebÃ¤ude
- **Performance**: ~2-5 Sekunden fÃ¼r Jahressimulation

### 4. **IDF-Manipulation mit eppy**
```python
from eppy.modeleditor import IDF

IDF.setiddname("/home/luma/EnergyPlus-.../Energy+.idd")
idf = IDF("gebÃ¤ude.idf")

# Objekte hinzufÃ¼gen/Ã¤ndern
zone = idf.newidfobject('ZONE')
zone.Name = "MeinRaum"

idf.saveas("modified.idf", encoding='utf-8')
```
- **Status**: âœ… Funktioniert
- **Wichtig**: Immer `encoding='utf-8'` verwenden fÃ¼r Umlaute!

### 5. **VerfÃ¼gbare Ressourcen**
- **Wetterdaten**: âœ… Salzburg (data/weather/example.epw)
- **Beispiel-GebÃ¤ude**: âœ… 100+ in `~/EnergyPlus-.../ExampleFiles/`
- **Dokumentation**: âœ… Umfassend (siehe README.md)

---

## âš ï¸ BEKANNTE PROBLEME

### 1. **src/geometry/simple_box.py - NICHT FUNKTIONSFÃ„HIG**

**Problem**: API-InkompatibilitÃ¤t zwischen eppy und EnergyPlus 23.2

**Details**:
- Feldnamen haben sich in EnergyPlus 23.2 geÃ¤ndert
- Z.B.: `Zone_Name` â†’ `Zone_or_ZoneList_or_Space_or_SpaceList_Name`
- `newidfobject()` ohne Template-IDF funktioniert nicht

**Symptome**:
```python
AttributeError: 'IDF' object has no attribute 'model'
# ODER
unknown field Zone_Name
```

**Workaround**:
```python
# NICHT funktioniert:
idf = IDF()  # Leeres IDF

# FUNKTIONIERT:
# 1. Template-IDF erstellen
template = "VERSION, 23.2;\n"
with open("/tmp/template.idf", "w") as f:
    f.write(template)

# 2. Template laden
idf = IDF("/tmp/template.idf")

# 3. Jetzt kÃ¶nnen Objekte hinzugefÃ¼gt werden
```

**Status**: ğŸ”§ BenÃ¶tigt Refactoring
**PrioritÃ¤t**: Mittel (Workaround verfÃ¼gbar)

### 2. **Fenster-Generierung**

**Problem**: Vertex-Berechnung fÃ¼r FENESTRATIONSURFACE:DETAILED nicht implementiert

**Status**: âš ï¸ Deaktiviert (siehe simple_box.py Zeile 360-362)
**Workaround**: Beispiel-IDFs mit Fenstern als Basis verwenden

### 3. **Encoding-Probleme mit Umlauten**

**Problem**: Default encoding in eppy ist 'latin-1'

**LÃ¶sung**: Immer explizit setzen:
```python
idf.saveas("datei.idf", encoding='utf-8')
```

---

## ğŸ”§ WICHTIGE PFADE & BEFEHLE

### Aktivierung der Umgebung
```bash
cd /mnt/c/Users/lugma/source/repos/AI_BS
source venv/bin/activate
```

### EnergyPlus ausfÃ¼hren
```bash
~/EnergyPlus-23.2.0-7636e6b3e9-Linux-Ubuntu22.04-x86_64/energyplus \
  -w data/weather/example.epw \
  -d output/results \
  input.idf
```

### IDD-Datei (wichtig fÃ¼r eppy)
```python
IDD_PATH = "/home/luma/EnergyPlus-23.2.0-7636e6b3e9-Linux-Ubuntu22.04-x86_64/Energy+.idd"
```

### Beispiel-Dateien
```bash
EXAMPLES_DIR = "~/EnergyPlus-23.2.0-7636e6b3e9-Linux-Ubuntu22.04-x86_64/ExampleFiles/"
```

---

## ğŸ“ TYPISCHE WORKFLOWS

### Workflow 1: Bestehendes GebÃ¤ude simulieren
```bash
# 1. Beispiel kopieren
cp ~/EnergyPlus-.../ExampleFiles/RefBldgSmallOffice.idf mein_projekt.idf

# 2. Simulieren
~/EnergyPlus-.../energyplus -w data/weather/example.epw -d output/results mein_projekt.idf

# 3. Ergebnisse anschauen
explorer.exe output/results/eplustbl.htm
```

### Workflow 2: GebÃ¤ude mit Python anpassen
```python
from eppy.modeleditor import IDF
from pathlib import Path

# Setup
IDF.setiddname("/home/luma/EnergyPlus-.../Energy+.idd")

# Laden
idf = IDF("mein_projekt.idf")

# Anpassen (siehe MANUAL_GEBAEUDE_ANPASSUNG.md fÃ¼r Details)
building = idf.idfobjects['BUILDING'][0]
building.Name = "Mein GebÃ¤ude Salzburg"

# Speichern
idf.saveas("modified.idf", encoding='utf-8')
```

### Workflow 3: Parameterstudie
```python
# Siehe beispiel_parameterstudie.py (falls vorhanden)
# Oder erstellen als nÃ¤chstes!
```

---

## ğŸš€ NÃ„CHSTE ENTWICKLUNGSSCHRITTE

### Kurzfristig (PrioritÃ¤t HOCH)
1. **simple_box.py reparieren**
   - Feldnamen fÃ¼r EnergyPlus 23.2 aktualisieren
   - Template-basierte IDF-Erstellung implementieren
   - Unit-Tests schreiben

2. **Beispiel-Skripte funktionsfÃ¤hig machen**
   - 01_simple_box_simulation.py debuggen
   - 02_batch_simulation.py testen

3. **Parameterstudie-Beispiel erstellen**
   - Z.B. DÃ¤mmstÃ¤rke-Variation
   - Automatische Ergebnis-Vergleich

### Mittelfristig
4. **Post-Processing-Modul**
   - SQL-Datenbank-Parser
   - Kennzahlen-Extraktion
   - Automatische Grafiken (matplotlib)

5. **TABULA-Integration**
   - Deutsche GebÃ¤udetypologie
   - Automatische Material-Auswahl

6. **Batch-Processing testen**
   - Parallelisierung verifizieren
   - Performance-Optimierung

### Langfristig
7. **Co-Simulation (FMI/FMU)**
8. **Hardware-in-the-Loop**
9. **ML-Integration**
10. **Web-GUI**

---

## ğŸ› DEBUGGING-TIPPS

### Problem: Simulation schlÃ¤gt fehl
```bash
# Fehlerlog anschauen
cat output/results/eplusout.err | grep "Severe"
```

### Problem: eppy-Fehler
```python
# IDF-Initialisierung prÃ¼fen
print(f"Has model: {hasattr(idf, 'model')}")

# VerfÃ¼gbare Objekt-Typen
print(idf.idfobjects.keys())
```

### Problem: Feldname unbekannt
```python
# Objektfelder inspizieren
obj = idf.newidfobject('ZONE')
print([f for f in dir(obj) if not f.startswith('_')])
```

### Problem: Encoding-Fehler
```python
# Immer UTF-8 verwenden
idf.saveas("file.idf", encoding='utf-8')
```

---

## ğŸ“Š BEISPIEL-NUTZUNG

### Live-Demo (funktioniert!)
```bash
# Im Projekt-Root:
source venv/bin/activate

# Minimal-Beispiel
python quick_start.py

# VollstÃ¤ndige Simulation
cp ~/EnergyPlus-.../ExampleFiles/RefBldgSmallOfficeNew2004_Chicago.idf demo.idf
~/EnergyPlus-.../energyplus -w data/weather/example.epw -d output/demo demo.idf
explorer.exe output/demo/eplustbl.htm
```

---

## ğŸ”‘ WICHTIGE ERKENNTNISSE

### Was funktioniert GUT:
- âœ… EnergyPlus-Simulationen (sehr stabil)
- âœ… IDF-Manipulation mit eppy (mit Vorsicht)
- âœ… Beispiel-Dateien als Basis verwenden
- âœ… Ergebnis-Analyse Ã¼ber HTML-Reports

### Was SCHWIERIG ist:
- âš ï¸ Vollautomatische Geometrie-Generierung
- âš ï¸ Feldnamen-KompatibilitÃ¤t zwischen Versionen
- âš ï¸ Komplexe HVAC-Systeme (viele AbhÃ¤ngigkeiten)

### Empfohlener Ansatz:
1. **Beispiel-IDF als Basis** verwenden
2. **Mit eppy parametrisch anpassen**
3. **Simulieren & Ergebnisse analysieren**
4. **Iterativ verbessern**

---

## ğŸ“š DOKUMENTATIONS-QUELLEN

### Intern (in diesem Projekt):
- `README.md` - VollstÃ¤ndige Projektdokumentation
- `WAS_IST_MÃ–GLICH.md` - Feature-Ãœbersicht
- `STATUS.md` - Technischer Status
- `LIVE_DEMO_ERGEBNISSE.md` - Beispiel-Workflow

### Extern:
- **EnergyPlus Docs**: https://energyplus.net/documentation
- **eppy Docs**: https://eppy.readthedocs.io/
- **Wetterdaten**: https://energyplus.net/weather

### Beispiele:
- `~/EnergyPlus-.../ExampleFiles/` - 100+ IDF-Dateien
- `~/EnergyPlus-.../DataSets/` - Material-Datenbanken

---

## ğŸ¤– FÃœR CLAUDE/KI-ASSISTENTEN

### Bei neuer Session:
1. Lies diese Datei zuerst
2. PrÃ¼fe `STATUS.md` fÃ¼r aktuelle Probleme
3. Schau in `WAS_IST_MÃ–GLICH.md` fÃ¼r Features

### Bekannte Bugs zu vermeiden:
- âŒ NICHT `IDF()` ohne Template verwenden
- âŒ NICHT ohne `encoding='utf-8'` speichern
- âŒ NICHT Feldnamen aus EnergyPlus 22.x verwenden

### Best Practices:
- âœ… Immer Beispiel-IDFs als Basis
- âœ… Encoding explizit setzen
- âœ… Feldnamen mit `dir(obj)` prÃ¼fen
- âœ… Templates fÃ¼r IDF-Erstellung nutzen

### Code-Patterns, die funktionieren:
```python
# IDF initialisieren
import tempfile
from eppy.modeleditor import IDF
from pathlib import Path

IDF.setiddname("/home/luma/EnergyPlus-.../Energy+.idd")

template = "VERSION, 23.2;\n"
with tempfile.NamedTemporaryFile(mode='w', suffix='.idf', delete=False) as f:
    f.write(template)
    temp_path = f.name

idf = IDF(temp_path)
Path(temp_path).unlink()

# Jetzt kann man arbeiten
zone = idf.newidfobject('ZONE')
zone.Name = "Test"
# ...

idf.saveas("output.idf", encoding='utf-8')
```

---

## ğŸ”„ UPDATE-LOG

### 2025-11-10 - Initiale Erstellung
- Projekt aufgesetzt
- EnergyPlus 23.2.0 installiert (WSL2)
- Python-Umgebung konfiguriert
- Live-Demo erfolgreich durchgefÃ¼hrt
- Bekannte Probleme dokumentiert
- `.claude.md` erstellt

### NÃ¤chstes Update:
- [ ] simple_box.py repariert
- [ ] Parameterstudie-Beispiel erstellt
- [ ] Post-Processing-Modul implementiert

---

## ğŸ’¡ QUICK COMMANDS

```bash
# Projekt-Setup
cd /mnt/c/Users/lugma/source/repos/AI_BS
source venv/bin/activate

# Test ausfÃ¼hren
python quick_start.py

# Simulation
~/EnergyPlus-23.2.0-7636e6b3e9-Linux-Ubuntu22.04-x86_64/energyplus \
  -w data/weather/example.epw -d output/test input.idf

# Ergebnisse Ã¶ffnen
explorer.exe output/test/eplustbl.htm

# Tests
pytest tests/

# Code-Formatierung
black src/ tests/ examples/
```

---

**Letztes Update**: 2025-11-10 22:20 UTC
**NÃ¤chste PrioritÃ¤t**: simple_box.py reparieren
**Status**: ğŸŸ¢ FunktionsfÃ¤hig fÃ¼r manuelle/semi-automatische Workflows
